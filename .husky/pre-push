# Run validation checks before push
echo "ğŸ” Running pre-push validation..."
echo ""

# Check if ignoreBuildErrors is enabled
if grep -q "ignoreBuildErrors: true" next.config.ts; then
  echo "â„¹ï¸  Note: ignoreBuildErrors is enabled (documented)"
  echo "ğŸ” Running: Lint + Build (skipping type-check for existing errors)"
  echo ""
  
  # Check 1: Lint (always run)
  echo "1ï¸âƒ£  ESLint check..."
  npm run lint || {
    echo ""
    echo "âŒ Lint failed!"
    echo "ğŸ”§ Fix ESLint errors before pushing."
    exit 1
  }
  
  # Check 2: Build (always run)
  echo ""
  echo "2ï¸âƒ£  Production build..."
  npm run build || {
    echo ""
    echo "âŒ Build failed!"
    echo "ğŸ”§ Fix build errors before pushing."
    exit 1
  }
  
else
  # Full validation when ignoreBuildErrors is false
  echo "ğŸ” Running: Type check + Lint + Build (full validation)"
  echo ""
  
  # Check 1: Type check
  echo "1ï¸âƒ£  Type check..."
  npm run type-check || {
    echo ""
    echo "âŒ Type check failed!"
    echo "ğŸ”§ Fix TypeScript errors before pushing."
    exit 1
  }
  
  # Check 2: Lint
  echo ""
  echo "2ï¸âƒ£  ESLint check..."
  npm run lint || {
    echo ""
    echo "âŒ Lint failed!"
    echo "ğŸ”§ Fix ESLint errors before pushing."
    exit 1
  }
  
  # Check 3: Build
  echo ""
  echo "3ï¸âƒ£  Production build..."
  npm run build || {
    echo ""
    echo "âŒ Build failed!"
    echo "ğŸ”§ Fix build errors before pushing."
    exit 1
  }
fi

echo ""
echo "âœ… All checks passed! Safe to push."

